{{!
  Copyright (c) HashiCorp, Inc.
  SPDX-License-Identifier: MPL-2.0
}}

<Rose::Form
  @edit={{@edit}}
  @onSubmit={{fn @submit this.grantStrings}}
  @cancel={{@cancel}}
  @disabled={{@model.isSaving}}
  @showEditToggle={{if @model.isNew false true}}
  as |form|
>
  <Form::Field::ListWrapper
    @layout='horizontal'
    @isOptional={{true}}
    @disabled={{form.disabled}}
  >
    <:fieldset as |F|>
      <F.Legend>
        {{t 'form.grant.label'}}
      </F.Legend>
      <F.HelperText>
        {{t 'form.grant.label'}}
      </F.HelperText>

      {{#if @model.errors.grant_strings}}
        <F.Error as |E|>
          {{#each @model.errors.grant_strings as |error|}}
            <E.Message>{{error.message}}</E.Message>
          {{/each}}
        </F.Error>
      {{/if}}
    </:fieldset>
    <:field as |F|>
      <F.TextInput
        @name='grant_strings'
        @options={{this.grants}}
        @model={{@model}}
        @isInvalid={{@model.errors.grant_strings}}
        @addOption={{fn this.createGrant @addGrant}}
      />
    </:field>
  </Form::Field::ListWrapper>

  {{#if (can 'setGrants role' @model)}}
    <form.actions
      @enableEditText={{t 'actions.edit-form'}}
      @submitText={{t 'actions.save'}}
      @cancelText={{t 'actions.cancel'}}
    />
  {{/if}}
</Rose::Form>