{{!
  Copyright (c) HashiCorp, Inc.
  SPDX-License-Identifier: MPL-2.0
}}

<Breadcrumbs::Item
  @text={{t 'resources.alias.title'}}
  @route='scopes.scope.targets.target.manage-alias'
/>
<Rose::Layout::Page as |page|>
  <page.breadcrumbs>
    <Breadcrumbs::Container />
  </page.breadcrumbs>
  <page.header>
    <h2>
      {{t 'resources.alias.title'}}
      <DocLink @doc='aliases' @iconSize='large' />
    </h2>
    <p>{{t 'resources.alias.description'}}</p>
    <Hds::Copy::Snippet @color='secondary' @textToCopy={{@model.id}} />
  </page.header>
  {{#let
    (hash
      canRead=(can 'read model' @model) canDelete=(can 'delete model' @model)
    )
    as |perms|
  }}
    <page.actions>
      {{#if (or perms.canRead perms.canDelete)}}

        <Hds::Dropdown as |dd|>
          <dd.ToggleButton
            data-test-manage-dropdown
            @text={{t 'actions.manage'}}
            @color='secondary'
          />
          {{#if (and perms.canRead @model.destination_id)}}
            <dd.Interactive
              @text={{t 'actions.clear'}}
              {{on 'click' (route-action 'clearAlias' @model)}}
            />
          {{/if}}
          {{#if perms.canDelete}}
            <dd.Separator />
            <dd.Interactive
              @color='critical'
              @text={{t 'actions.delete'}}
              {{on 'click' (route-action 'deleteAlias' @model)}}
            />
          {{/if}}
        </Hds::Dropdown>
      {{/if}}
    </page.actions>
  {{/let}}

  <page.body>
    <Form::Alias
      @model={{@model}}
      @submit={{route-action 'save' @model}}
      @cancel={{route-action 'cancel' @model}}
    />
  </page.body>
</Rose::Layout::Page>