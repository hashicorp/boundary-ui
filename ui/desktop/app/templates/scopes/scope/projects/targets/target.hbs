{{!
  Copyright (c) HashiCorp, Inc.
  SPDX-License-Identifier: MPL-2.0
}}

{{page-title @model.target.displayName}}

<Rose::Layout::Page as |page|>

  <page.header>
    <h1 class='target-details-header'>
      <Hds::IconTile @color='boundary' @icon='target' />
      {{@model.target.displayName}}
    </h1>
  </page.header>

  <page.actions>
    {{#if (can 'connect target' @model.target)}}
      <Hds::Button
        data-test-target-detail-connect-button
        @text={{t 'resources.session.actions.connect'}}
        @icon='entry-point'
        @iconPosition='trailing'
        disabled={{not (can 'initiateConnection target' @model.target)}}
        {{on 'click' (route-action 'preConnect' @model this.toggle)}}
      />
    {{/if}}
  </page.actions>

  <page.body class='details-screen-body'>
    <Rose::Layout::BodyContent as |bc|>
      {{#if (can 'initiateConnection target' @model.target)}}
        <Target::HostModal
          @showModal={{this.isConnecting}}
          @toggle={{this.toggle}}
          @connect={{route-action 'connect'}}
          @hosts={{@model.hosts}}
          @target={{@model.target}}
        />
      {{/if}}
      <bc.Body class='target-details-body'>
        <Hds::ApplicationState as |A|>
          {{#if (can 'initiateConnection target' @model.target)}}
            <A.Header
              @title={{t 'resources.target.messages.connect-more-info.title'}}
            />
            <A.Body
              @text={{t
                'resources.target.messages.connect-more-info.description'
              }}
            />
          {{else}}
            <A.Header
              @title={{t
                'resources.target.messages.cannot-connect.title'
                targetDisplayName=@model.target.displayName
              }}
            />
            <A.Body
              @text={{t 'resources.target.messages.cannot-connect.description'}}
            />
          {{/if}}
        </Hds::ApplicationState>
      </bc.Body>
      <bc.Sidebar>
        <div class='details-sidebar'>
          <div>
            <div
              class='title hds-typography-display-200 hds-font-weight-semibold'
            >
              {{t 'resources.target.details'}}
            </div>
            <Rose::MetadataList @orientation='vertical' as |list|>
              {{! Target name }}
              <list.Item @icon='target' @color='faint'>
                {{@model.target.name}}
              </list.Item>
              {{! Project name }}
              <list.Item @icon='grid' @color='faint'>
                {{@model.target.project.displayName}}
              </list.Item>
              {{! Target description }}
              {{#if @model.target.description}}
                <list.Item @icon='message-circle-fill' @color='faint'>
                  {{@model.target.description}}
                </list.Item>
              {{/if}}
              {{! Target type }}
              <list.Item class='resource-type' @icon='terminal' @color='faint'>
                {{#if @model.target.isSSH}}
                  {{t 'resources.target.types.ssh'}}
                {{else}}
                  {{t 'resources.target.types.tcp'}}
                {{/if}}
              </list.Item>
              {{! Target address }}
              {{#if @model.target.address}}
                <list.Item
                  class='resource-type'
                  @icon='network-alt'
                  @color='faint'
                >
                  {{@model.target.address}}
                </list.Item>
              {{/if}}
              {{! Target ID }}
              <list.Item @icon='hash' @color='faint'>
                <Copyable
                  @text={{@model.target.id}}
                  @buttonText={{t 'actions.copy-to-clipboard'}}
                  @acknowledgeText={{t 'states.copied'}}
                >
                  {{@model.target.id}}
                </Copyable>
              </list.Item>
            </Rose::MetadataList>
          </div>
        </div>
      </bc.Sidebar>
    </Rose::Layout::BodyContent>
  </page.body>

</Rose::Layout::Page>